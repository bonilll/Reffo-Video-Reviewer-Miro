<div align="center">
<img width="1200" height="475" alt="GHBanner" src="https://github.com/user-attachments/assets/0aa67016-6eaf-458a-adb2-6e31a0763ed6" />
</div>

# Video Reviewer – Convex + Clerk

This project combines a React/Vite front‑end with a Convex backend and Clerk authentication to deliver a collaborative video review workflow with annotations, threaded comments, and frame-accurate navigation.

## Prerequisites

- Node.js 18+
- Convex CLI (`npm install -g convex`, optional but useful)
- Clerk account with a publishable key (Clerk SDKs supporting Session JWT V2)
- MinIO (or any S3-compatible storage) credentials

## Environment Variables

Create a `.env.local` in the project root. The template currently contains sensible defaults for local development:

```bash
# Convex local deployment
VITE_CONVEX_URL=http://127.0.0.1:3210
CONVEX_DEPLOYMENT=local:local-aleteam-videoreviewer

# Clerk
VITE_CLERK_PUBLISHABLE_KEY=pk_test_...
CLERK_JWT_ISSUER=https://clerk.accounts.dev

# MinIO / S3
MINIO_ENDPOINT=https://s3.reffo.studio
MINIO_ACCESS_KEY=...
MINIO_SECRET_KEY=...
MINIO_BUCKET=video-review-bucket
MINIO_REGION=us-east-1
MINIO_PUBLIC_URL=https://s3.reffo.studio/video-review-bucket
```

For the Convex runtime to access storage credentials, set them in the deployment environment (run while `npx convex dev` is active):

```bash
CONVEX_DEPLOYMENT=local:local-aleteam-videoreviewer npx convex env set MINIO_ENDPOINT https://s3.reffo.studio
CONVEX_DEPLOYMENT=local:local-aleteam-videoreviewer npx convex env set MINIO_ACCESS_KEY <access_key>
CONVEX_DEPLOYMENT=local:local-aleteam-videoreviewer npx convex env set MINIO_SECRET_KEY <secret_key>
CONVEX_DEPLOYMENT=local:local-aleteam-videoreviewer npx convex env set MINIO_BUCKET video-review-bucket
CONVEX_DEPLOYMENT=local:local-aleteam-videoreviewer npx convex env set MINIO_REGION us-east-1
CONVEX_DEPLOYMENT=local:local-aleteam-videoreviewer npx convex env set MINIO_PUBLIC_URL https://s3.reffo.studio/video-review-bucket
CONVEX_DEPLOYMENT=local:local-aleteam-videoreviewer npx convex env set CLERK_JWT_ISSUER https://clerk.accounts.dev
```

## Local Development

```bash
# install dependencies
npm install

# start the Convex dev backend (in a dedicated terminal)
npx convex dev

# run the Vite dev server
npm run dev
```

The app is available at `http://localhost:5173`. When developing on another device in the network, make sure to expose both the Vite server (defaults to 5173) and Convex dev server (defaults to 3210).

### Clerk compatibility notes

- Session JWT V2 requires compatible SDKs. This repo pins `@clerk/clerk-react@^5.61.0`, which includes the required Clerk.js version.
- If you turned on Client Trust (credential stuffing protection) in the Clerk dashboard, sign‑in may require a second factor on new devices. The app now delegates such cases to Clerk’s UI automatically.

## Production Build

```bash
npm run build
npm run preview
```

## Notes

- Uploads are streamed directly to MinIO via pre-signed URLs generated by Convex actions.
- Convex handles persistence for projects, videos, annotations, and comments. Data is scoped per Clerk user.
- Undo/redo controls are currently placeholders; annotations and comments persist immediately to the backend.
